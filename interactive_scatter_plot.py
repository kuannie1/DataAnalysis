import plotly.plotly as py
import plotly
import plotly.graph_objs as go
import plotly.tools as tls
from yahoo_finance import Share
from pprint import pprint
tls.set_credentials_file(username='umadesai', api_key='tlqzgdjqoz')

def get_stocks(stockName, startDate, endDate): 
    company = Share(stockName)
    dates = []
    values = []
    #company.refresh()
    stocks = (company.get_historical(startDate, endDate))
    for item in stocks:
        if 'Date' in item:
            actualDate = item.get('Date')
        if 'Open' in item:
            actualOpen = item.get('Open')
        dates += ([actualDate])
        values += ([actualOpen])

    return dates, values

def interactive_scatter_plot(stockName, startDate, endDate):
    

    stock_info = get_stocks(stockName, startDate, endDate)
    trace0 = go.Scatter(
        x = stock_info[0],
        y = stock_info[1],

        mode='markers',
        marker=dict(size=12,
                    line=dict(width=1)
                   ),
        name='Stock Price',
        text=[],
        )

    trace1 = go.Scatter(
        x = ['2015-12-31', '2015-12-30', '2015-12-29', '2015-12-28', '2015-12-24', '2015-12-23', '2015-12-22', '2015-12-21', '2015-12-18', '2015-12-17', '2015-12-16', '2015-12-15', '2015-12-14', '2015-12-11', '2015-12-10', '2015-12-09', '2015-12-08', '2015-12-07', '2015-12-04', '2015-12-03', '2015-12-02', '2015-12-01', '2015-11-30', '2015-11-27', '2015-11-25', '2015-11-24', '2015-11-23', '2015-11-20', '2015-11-19', '2015-11-18', '2015-11-17', '2015-11-16', '2015-11-13', '2015-11-12', '2015-11-11', '2015-11-10', '2015-11-09', '2015-11-06', '2015-11-05', '2015-11-04', '2015-11-03', '2015-11-02', '2015-10-30', '2015-10-29', '2015-10-28', '2015-10-27', '2015-10-26', '2015-10-23', '2015-10-22', '2015-10-21', '2015-10-20', '2015-10-19', '2015-10-16', '2015-10-15', '2015-10-14', '2015-10-13', '2015-10-12', '2015-10-09', '2015-10-08', '2015-10-07', '2015-10-06', '2015-10-05', '2015-10-02', '2015-10-01', '2015-09-30', '2015-09-29', '2015-09-28', '2015-09-25', '2015-09-24', '2015-09-23', '2015-09-22', '2015-09-21', '2015-09-18', '2015-09-17', '2015-09-16', '2015-09-15', '2015-09-14', '2015-09-11', '2015-09-10', '2015-09-09', '2015-09-08', '2015-09-04', '2015-09-03', '2015-09-02', '2015-09-01', '2015-08-31', '2015-08-28', '2015-08-27', '2015-08-26', '2015-08-25', '2015-08-24', '2015-08-21', '2015-08-20', '2015-08-19', '2015-08-18', '2015-08-17', '2015-08-14', '2015-08-13', '2015-08-12', '2015-08-11', '2015-08-10', '2015-08-07', '2015-08-06', '2015-08-05', '2015-08-04', '2015-08-03', '2015-07-31', '2015-07-30', '2015-07-29', '2015-07-28', '2015-07-27', '2015-07-24', '2015-07-23', '2015-07-22', '2015-07-21', '2015-07-20', '2015-07-17', '2015-07-16', '2015-07-15', '2015-07-14', '2015-07-13', '2015-07-10', '2015-07-09', '2015-07-08', '2015-07-07', '2015-07-06', '2015-07-02', '2015-07-01', '2015-06-30', '2015-06-29', '2015-06-26', '2015-06-25', '2015-06-24', '2015-06-23', '2015-06-22', '2015-06-19', '2015-06-18', '2015-06-17', '2015-06-16', '2015-06-15', '2015-06-12', '2015-06-11', '2015-06-10', '2015-06-09', '2015-06-08', '2015-06-05', '2015-06-04', '2015-06-03', '2015-06-02', '2015-06-01', '2015-05-29', '2015-05-28', '2015-05-27', '2015-05-26', '2015-05-22', '2015-05-21', '2015-05-20', '2015-05-19', '2015-05-18', '2015-05-15', '2015-05-14', '2015-05-13', '2015-05-12', '2015-05-11', '2015-05-08', '2015-05-07', '2015-05-06', '2015-05-05', '2015-05-04', '2015-05-01', '2015-04-30', '2015-04-29', '2015-04-28', '2015-04-27', '2015-04-24', '2015-04-23', '2015-04-22', '2015-04-21', '2015-04-20', '2015-04-17', '2015-04-16', '2015-04-15', '2015-04-14', '2015-04-13', '2015-04-10', '2015-04-09', '2015-04-08', '2015-04-07', '2015-04-06', '2015-04-02', '2015-04-01', '2015-03-31', '2015-03-30', '2015-03-27', '2015-03-26', '2015-03-25', '2015-03-24', '2015-03-23', '2015-03-20', '2015-03-19', '2015-03-18', '2015-03-17', '2015-03-16', '2015-03-13', '2015-03-12', '2015-03-11', '2015-03-10', '2015-03-09', '2015-03-06', '2015-03-05', '2015-03-04', '2015-03-03', '2015-03-02', '2015-02-27', '2015-02-26', '2015-02-25', '2015-02-24', '2015-02-23', '2015-02-20', '2015-02-19', '2015-02-18', '2015-02-17', '2015-02-13', '2015-02-12', '2015-02-11', '2015-02-10', '2015-02-09', '2015-02-06', '2015-02-05', '2015-02-04', '2015-02-03', '2015-02-02', '2015-01-30', '2015-01-29', '2015-01-28', '2015-01-27', '2015-01-26', '2015-01-23', '2015-01-22', '2015-01-21', '2015-01-20', '2015-01-16', '2015-01-15', '2015-01-14', '2015-01-13', '2015-01-12', '2015-01-09', '2015-01-08', '2015-01-07', '2015-01-06', '2015-01-05', '2015-01-02'],
        y=[3.109985, 0.00, 4.100006, 5.970001, 8.869995, 0.160004, 1.380005, 4.25, 3.780029, 5.01001, 6.150024, 0.130005, 6.679993, 3.00, 4.00, 6.599976, 2.109985, 6.830017, 8.890015, 7.950012, 2.840027, 3.280029, 7.50, 4.47998, 4.710022, 7.02002, 4.080017, 2.00, 5.409973, 3.890015, 5.98999, 1.22998, 3.599976, 1.840027, 1.530029, 3.47998, 3.01001, 9.00, 6.72998, 5.849976, 7.669983, 0.00, 8.00, 9.419983, 6.890015, 9.679993, 6.640015, 6.98999, 6.460022, 0.609985, 7.25, 3.429993, 7.00, 7.559998, .73900, 7.4700, 4.570007, 4.77002, 2.00, 3.50, 7.159973, 6.859985, 7.47998, 717.599976, 714.890015, 707.590027, 730.52002, 733.830017, 729.77002, 727.50, 724.98999, 729.299988, 728.97998, 728.469971, 734.75, 725.809998, 728.47998, 721.219971, 718.25, 734.00, 731.460022, 718.359985, 722.50, 713.690002, 697.950012, 719.789978, 725.00, 713.119995, 703.150024, 722.26001, 695.00, 729.47998, 741.309998, 742.200012, 754.049988, 744.190002, 745.940002, 748.099976, 741.150024, 742.619995, 755.669983, 751.969971, 758.48999, 749.390015, 741.98999, 743.469971, 745.72998, 737.00, 732.00, 735.150024, 726.00, 725.00, 723.50, 695.00, 678.00, 665.700012, 658.320007, 661.50, 657.400024, 658.00, 646.119995, 630.109985, 622.48999, 619.400024, 606.090027, 599.849976, 609.099976, 606.309998, 603.00, 604.219971, 608.00, 613.890015, 615.00, 620.869995, 617.50, 605.23999, 607.869995, 600.50, 602.409973, 607.50, 605.00, 609.00, 605.640015, 606.969971, 611.929993, 608.159973, 606.099976, 609.00, 613.099976, 615.01001, 628.00, 617.50, 623.159973, 624.669983, 635.00, 628.330017, 632.929993, 637.440002, 632.559998, 634.75, 636.030029, 636.00, 630.50, 630.330017, 636.00, 627.00, 625.330017, 631.840027, 636.690002, 628.960022, 631.98999, 637.700012, 643.75, 640.130005, 638.580017, 641.97998, 655.130005, 691.400024, 686.77002, 678.789978, 678.00, 683.26001, 681.159973, 680.700012, 666.099976, 653.789978, 658.460022, 659.419983, 648.47998, 653.00, 650.00, 653.820007, 668.070007, 660.51001, 662.27002, 680.00, 686.50, 685.650024, 684.960022, 673.969971, 669.26001, 677.00, 676.090027, 668.00, 662.530029, 658.679993, 657.140015, 658.01001, 666.919983, 667.159973, 664.599976, 670.380005, 664.969971, 670.50, 675.00, 670.299988, 670.150024, 673.469971, 670.590027, 674.599976, 669.960022, 674.460022, 671.669983, 671.080017, 666.359985, 652.00, 655.780029, 677.00, 679.799988, 680.280029, 716.50, 713.549988, 714.640015, 715.549988, 722.969971, 718.380005, 715.340027, 715.47998, 706.809998, 704.400024, 714.890015, 696.570007, 709.00, 703.210022, 715.73999, 718.890015, 721.849976, 702.50, 668.400024, 666.789978, 678.400024, 686.00,],
        mode='markers',
        marker=dict(size=12,
                    line=dict(width=1)
                   ),
        name='Public Opinion',
        yaxis = 'y2',
        text=[],
            )

    data = [trace0, trace1]
    layout = go.Layout(
        title=str(stockName)+' from '+str(startDate) + ' to ' + str(endDate),
        hovermode='closest',
        xaxis=dict(
            title='Date',
            ticklen=5,
            zeroline=True,
            gridwidth=1,
        ),
        yaxis=dict(
            title='Stock Market Valuation',
            ticklen=5,
            gridwidth=1,
        ),
        yaxis2=dict(
            title = 'Company Popularity',
            ticklen=5,
            gridwidth=1,
            overlaying='y',
            side='right'
            )
    )
    fig = go.Figure(data=data, layout=layout)
    plotly.offline.plot(fig, filename='stockprice_v_publicopinion')

interactive_scatter_plot('LOCO', '2015-01-01', '2015-12-31')